{"version":3,"file":"static/js/main.c4c797bc.js","mappings":"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","sources":["../webpack/bootstrap","../webpack/runtime/publicPath","api.js","index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","__webpack_require__.p = \"/Unsplash-Search/\";","//src/api.js\nexport const CLIENT_ID = 'K6HLHwT0DgSPJpHiuvkrh5pJG7yrcGV7KKHafIpOc-s';\n\nexport async function fetchUnsplashImages(query, page = 1) {\n    const perPage = 12;\n    const url = `https://api.unsplash.com/search/photos?page=${page}&per_page=${perPage}&query=${encodeURIComponent(query)}&client_id=${CLIENT_ID}`;\n\n    const response = await fetch(url, {\n        headers: {\n            Authorization: `Client-ID ${CLIENT_ID}`,\n        },\n    });\n\n    if (!response.ok) {\n        throw new Error(`Ошибка API: ${response.status}`);\n    }\n\n    return await response.json();\n}","//src/index.js\nimport './styles/main.css';\nimport './styles/adaptive.css';\nimport './styles/buttons.css';\nimport './styles/images.css'\nimport './assets/fonts/Montserrat-Regular.ttf';\nimport { fetchUnsplashImages } from './api.js';\n\nconst CACHE_KEY = 'unsplash_cache';\nconst LAST_QUERY_KEY = 'unsplash_last_query';\n\nfunction saveCache(query, page, data) {\n    if (page === 1) {\n        localStorage.setItem(CACHE_KEY, JSON.stringify({ query, page, data }));\n        localStorage.setItem(LAST_QUERY_KEY, query);\n    }\n}\n\nfunction loadCache(query, page) {\n    const cached = JSON.parse(localStorage.getItem(CACHE_KEY));\n    if (cached && cached.query === query && cached.page === page) {\n        return cached.data;\n    }\n    return null;\n}\n\nwindow.onload = () => {\n    const images = document.getElementById('images');\n    const searchInput = document.getElementById('search');\n    const searchBtn = document.getElementById('search-btn');\n    const actions = document.getElementById('actions');\n\n    let page = 1;\n    let totalPage = null;\n    let loading = false;\n\n    function renderImages(data) {\n        if (!data.results || data.results.length === 0) {\n            if (page > 1) {\n                page--;\n                actions.classList.remove('active');\n                images.innerHTML = '<div class=\"no-results\">Больше изображений нет.</div>';\n            } else {\n                images.innerHTML = '<div class=\"no-results\">Ничего не найдено.</div>';\n                actions.classList.remove('active');\n            }\n            return;\n        }\n\n        images.innerHTML = data.results.map(item => `\n        <div class=\"images-item\" onclick=\"window.open('${item.links.html}', '_blank')\">\n            <img class=\"images-item-image\" \n                 src=\"${item.urls.small}\" \n                 alt=\"${item.alt_description || ''}\"\n                 loading=\"lazy\"\n                 onload=\"this.style.opacity=1\">\n            <div class=\"images-item-overlay\">\n                <div class=\"images-item-title\">\n                    ${item.description ? item.description.slice(0, 60) + (item.description.length > 60 ? '...' : '') : ''}\n                </div>\n                <div class=\"images-item-author\">Автор: ${item.user.name}</div>\n            </div>\n        </div>\n    `).join('');\n\n        totalPage = Math.ceil(data.total / 12); // <-- ключевое исправление\n\n        actions.children[1].textContent = `Страница ${page}`;\n        actions.classList.add('active');\n\n        actions.children[0].disabled = (page <= 1);\n        actions.children[2].disabled = (page >= totalPage);\n    }\n\n\n    async function loadImages() {\n        const query = searchInput.value.trim();\n        if (!query) return;\n\n        try {\n            loading = true;\n            images.innerHTML = '';\n            actions.classList.remove('active');\n            totalPage = null;\n\n            const cached = loadCache(query, page);\n            if (cached) {\n                renderImages(cached);\n                return;\n            }\n\n            const data = await fetchUnsplashImages(query, page);\n            saveCache(query, page, data);\n            renderImages(data);\n        } catch {\n            console.error('Ошибка загрузки');\n        } finally {\n            loading = false;\n        }\n    }\n\n    searchBtn.onclick = () => {\n        const query = searchInput.value.trim();\n        if (query) {\n            // Удаляем предыдущий кэш\n            localStorage.removeItem(CACHE_KEY);\n            localStorage.removeItem(LAST_QUERY_KEY);\n\n            page = 1;\n            loadImages();\n        }\n    };\n\n    actions.children[0].onclick = () => {\n        if (page > 1) {\n            page--;\n            loadImages();\n        }\n    };\n\n    actions.children[2].onclick = () => {\n        if (page < totalPage) {\n            page++;\n            loadImages();\n        }\n    };\n    const lastQuery = localStorage.getItem(LAST_QUERY_KEY);\n\n    if (lastQuery) {\n        searchInput.value = lastQuery;\n        page = 1;\n        loadImages();\n    }\n\n};"],"names":["__webpack_require__","CLIENT_ID","CACHE_KEY","LAST_QUERY_KEY","window","onload","images","document","getElementById","searchInput","searchBtn","actions","page","totalPage","loading","renderImages","data","results","length","innerHTML","map","item","concat","links","html","urls","small","alt_description","description","slice","user","name","join","Math","ceil","total","children","textContent","classList","add","disabled","remove","async","loadImages","query","value","trim","cached","JSON","parse","localStorage","getItem","loadCache","url","arguments","undefined","encodeURIComponent","response","fetch","headers","Authorization","ok","Error","status","json","fetchUnsplashImages","setItem","stringify","saveCache","_unused","console","error","onclick","removeItem","lastQuery"],"sourceRoot":""}